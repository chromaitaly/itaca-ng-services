/*******************************************************************************
********************************************************************************
********************************************************************************
***	   itaca-ng-services														 
***    Copyright (C) 2016-2018   Chroma Italy Hotels srl	 
***                                                                          
***    This program is free software: you can redistribute it and/or modify  
***    it under the terms of the GNU General Public License as published by  
***    the Free Software Foundation, either version 3 of the License, or     
***    (at your option) any later version.                                   
***                                                                          
***    This program is distributed in the hope that it will be useful,       
***    but WITHOUT ANY WARRANTY; without even the implied warranty of        
***    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         
***    GNU General Public License for more details.                          
***                                                                          
***    You should have received a copy of the GNU General Public License     
***    along with this program.  If not, see <http://www.gnu.org/licenses/>. 
********************************************************************************
********************************************************************************
*******************************************************************************/
!function(){"use strict";angular.module("itaca.services",["ngMaterial","itaca.utils","pascalprecht.translate","tmh.dynamicLocale","LocalStorageModule"])}(),function(){"use strict";function e(e,r){var t={url:"/api/rs/public/storage",get:function(){var t=r.defer();return e(this.url).get().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting application storage info")}),t.promise}};return t}e.$inject=["$resource","$q"],angular.module("itaca.services").factory("AboutStorage",e)}(),function(){"use strict";function e(e,r){var t={url:"/api/rs/public/about",get:function(){var t=r.defer();return e(this.url).get().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting application info")}),t.promise}};return t}e.$inject=["$resource","$q"],angular.module("itaca.services").factory("About",e)}(),function(){"use strict";function e(e,r){var t={url:"/api/rs/secure/config"},n={amazon:{method:"GET",url:t.url+"/amz"},creditCard:{method:"GET",url:t.url+"/cc"}};return t.API=e(t.url,null,n),t.amazon=function(){var t=r.defer();return this.API.amazon().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting amz config")}),t.promise},t.creditCard=function(){var t=r.defer();return this.API.creditCard().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting credit card config")}),t.promise},t}e.$inject=["$resource","$q"],angular.module("itaca.services").factory("Config",e)}(),function(){"use strict";function e(e,r){var t={url:"https://restcountries.eu/rest/v2"},n=function(e,t){var r=t();return delete r["X-Requested-With"],delete r["x-requested-with"],e},o={all:{method:"GET",url:t.url+"/all",isArray:!0,transformRequest:n},getByName:{method:"GET",url:t.url+"/name/:name",isArray:!0,transformRequest:n},getByIso:{method:"GET",url:t.url+"/alpha/:iso",transformRequest:n}};return t.REQUEST=e(this.url,null,o),t.all=function(){var t=r.defer();return this.REQUEST.all().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting countries")}),t.promise},t.getByName=function(e){var t=r.defer();return e?this.REQUEST.getByName({name:e}).$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting country")}):t.reject("Name not defined"),t.promise},t.getByIso=function(e){var t=r.defer();return e?this.REQUEST.getByIso({iso:e}).$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting country")}):t.reject("ISO code not defined"),t.promise},t}e.$inject=["$resource","$q"],angular.module("itaca.services").factory("CountryAPI",e)}(),function(){"use strict";function u(n,o,i,e,c,a,s,t,r,l){var u=this;this.$$cookieName=t,this.$$ratesCookieName=r,this.$$accessKey=l,this.API=e("https://data.fixer.io/api/latest",{access_key:u.$$accessKey}),this.current={iso:"EUR",symbol:"â‚¬",rate:1},this.$init=function(){u.set()},this.all=function(){var t=i.defer(),r={importants:{},others:{}};if(u.supported){var n=_.pickBy(a.getCurrencies(),function(e,t){return!_.isNil(u.supported[t])||t==u.current.iso});_.forEach(n,function(e,t){t==u.current.iso?(r.current=n[t],r.current.key=t):"EUR"==t||"USD"==t||"AUD"==t||"CAD"==t||"GBP"==t||"CNY"==t||"JPY"==t?r.importants[t]=n[t]:r.others[t]=n[t]}),t.resolve(r)}else u.set().then(function(){u.all().then(function(e){t.resolve(e)})});return t.promise},this.get=function(e){if(_.isNil(e))return null;var t=a.getCurrencyByCode(e);return _.isNil(t)?null:t},this.set=function(t){_.isNil(t)&&(t=o.get(u.$$cookieName),_.isNil(t)&&(t="EUR"));var r=i.defer(),n=u.get(t);return _.isNil(n)?r.reject("Currency not supported: "+t):u.getExchangeForCurrency(t).then(function(e){u.supported=e.rates,o.put(u.$$cookieName,t),s.currentCurrency=t,_.assign(u.current,{iso:t,symbol:n.symbol,rate:u.supported&&u.supported[t]?u.supported[t]:1}),r.resolve(u.current)},function(e){r.reject(e)}),r.promise},this.getExchangeForCurrency=function(r,e){var n=i.defer(),o=u.get(r);if(_.isNil(o))return n.reject("Currency not supported: "+r),n.promise;var a=c.get(u.$$ratesCookieName);_.isArray(a)?_.some(a,function(e){return!!_.isNil(e.date)||(moment.isDate(e.date)?moment(e.date):moment(e.date,"YYYY-MM-DD")).isBefore(moment(),"days")})&&(a=[],c.remove(u.$$ratesCookieName)):(a=[],c.remove(u.$$ratesCookieName));var s=_.find(a,function(e){return e.base.iso==r&&!_.isEmpty(e.rates)});return s&&!e?n.resolve(s):u.API.get({base:r}).$promise.then(function(e){if(e.success){s={base:{iso:e.base,symbol:o.symbol},date:e.date||new Date,rates:e.rates},a=a||[];var t=_.findIndex(a,function(e){return e.base.iso==r&&!_.isEmpty(e.rates)});0<=t?a[t]=s:a.push(s),c.set(u.$$ratesCookieName,a),n.resolve(s)}else n.reject(e.error&&e.error.info?e.error.info:"Error getting currencies")},function(e){n.reject(e.error&&e.error.info?e.error.info:"Error getting currencies")}),n.promise},this.getExchangeForCurrencyCached=function(t){var e=u.get(t);if(_.isNil(e))return n.warn("Currency not supported: "+t),null;var r=c.get(u.$$ratesCookieName);_.isArray(r)?_.some(r,function(e){return!!_.isNil(e.date)||(moment.isDate(e.date)?moment(e.date):moment(e.date,"YYYY-MM-DD")).isBefore(moment(),"days")})&&(r=[],c.remove(u.$$ratesCookieName)):(r=[],c.remove(u.$$ratesCookieName));return _.find(r,function(e){return e.base.iso==t&&!_.isEmpty(e.rates)})},this.$init()}angular.module("itaca.services").provider("Currency",function(){var i="X-ITACA-CURRENCY",c="X-ITACA-CURRENCY-RATES",l="de5e4f93006ee81e904bf3e0c95f7e28";this.init=function(e){e&&(e.cookieName&&(i=e.cookieName),e.postUrl&&(c=e.ratesCookieName),e.accessKey&&(l=e.accessKey))},this.setCookieName=function(e){_.isString(e)&&(i=e)},this.setRatesCookieName=function(e){_.isString(e)&&(c=e)},this.setAccessKey=function(e){_.isString(e)&&(l=e)},this.$get=["$log","$cookies","$q","$resource","localStorageService","iso4217","AppOptions",function(e,t,r,n,o,a,s){return new u(e,t,r,n,o,a,s,i,c,l)}]})}(),function(){"use strict";function e(e,t,i,n){var c={};c.autocompleteSvc=new google.maps.places.AutocompleteService,c.placesSvc=new google.maps.places.PlacesService(document.createElement("div")),c.geocoderSvc=new google.maps.Geocoder;c.url;return c.textSearch=function(e,t,r,n){var o=i.defer(),a={query:e,location:t,radius:r,type:n};return c.placesSvc.textSearch(a,function(e,t){t==google.maps.places.PlacesServiceStatus.OK?o.resolve(e):o.reject("Error getting place : "+t)}),o.promise},c.cities=function(e,t){var r=i.defer();return c.autocompleteSvc.getPlacePredictions({input:e,types:["(cities)"],componentRestrictions:{country:t}},function(e,t){t!=google.maps.places.PlacesServiceStatus.OK?r.reject("Error getting cities: "+t):r.resolve(e)}),r.promise},c.places=function(e,t){var r=i.defer();return c.autocompleteSvc.getPlacePredictions({input:e,types:["(regions)"],componentRestrictions:{country:t}},function(e,t){t!=google.maps.places.PlacesServiceStatus.OK?r.reject("Error getting cities: "+t):r.resolve(e)}),r.promise},c.addresses=function(e,t){var r=i.defer();return c.autocompleteSvc.getPlacePredictions({input:e,types:["address"],componentRestrictions:{country:t}},function(e,t){t!=google.maps.places.PlacesServiceStatus.OK?r.reject("Error getting addresses: "+t):r.resolve(e)}),r.promise},c.business=function(e,t){var r=i.defer();return c.autocompleteSvc.getPlacePredictions({input:e,types:["establishment"],componentRestrictions:{country:t}},function(e,t){t!=google.maps.places.PlacesServiceStatus.OK?r.reject("Error getting establishment: "+t):r.resolve(e)}),r.promise},c.zipCodes=function(e,t){var r=i.defer();return c.geocoderSvc.geocode({componentRestrictions:{country:t,postalCode:e}}).$promise.then(function(e){r.resolve(e.results)},function(e){r.reject(e.data&&e.data.message?e.data.message:"Error getting zip codes")}),r.promise},c.latLong=function(e){var r=i.defer();return c.geocoderSvc.geocode({address:e},function(e,t){t==google.maps.GeocoderStatus.OK?r.resolve(e[0]):r.reject("Error getting latlong : "+t)},function(e){n.error("Error getting latlong: "+e.statusText+" (code: "+e.status+")"),r.reject("Error getting latlong")}),r.promise},c.placeDetails=function(e){var r=i.defer();return c.placesSvc.getDetails({placeId:e},function(e,t){t==google.maps.places.PlacesServiceStatus.OK?r.resolve(e):r.reject("Error getting place : "+t)},function(e){n.error("Error getting place: "+e.statusText+" (code: "+e.status+")"),r.reject("Error getting place")}),r.promise},c.airportsByAddress=function(e){var t=i.defer();return e.geometry.location?t.resolve(c.airportsByLatlong(e)):c.latLong(e).then(function(e){t.resolve(c.airportsByLatlong(e))},function(e){t.reject(e)}),t.promise},c.airportsByLatlong=function(e){var s=i.defer(),t={location:{lat:e.geometry.location.lat(),lng:e.geometry.location.lng()},radius:5e4,query:"airport "+e.address_components[0].long_name+" principal",type:"airport"};return c.placesSvc.textSearch(t,function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){for(var r=[],n=0;n<e.length;n++){var o=e[n];if(3==o.types.length&&!o.permanently_closed){var a={country:"",city:""};a.address=o.vicinity,a.name=o.name,a.lat=o.geometry.location.lat(),a.lng=o.geometry.location.lng(),a.type="AIRPORT",r.push(a)}}s.resolve(r)}else s.reject("Error getting airports : "+t)}),s.promise},c.trainStationsByAddress=function(e){var t=i.defer();return e.geometry.location?t.resolve(c.trainStationsByLatlong(e)):c.latLong(e).then(function(e){t.resolve(c.trainStationsByLatlong(e))},function(e){t.reject(e)}),t.promise},c.trainStationsByLatlong=function(e){var s=i.defer(),t={location:{lat:e.geometry.location.lat(),lng:e.geometry.location.lng()},radius:5e4,query:"train station "+e.address_components[0].long_name+" principal",type:"train_station"};return c.placesSvc.textSearch(t,function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){for(var r=[],n=0;n<e.length;n++){var o=e[n];if(!o.permanently_closed){var a={country:"",city:""};a.address=o.vicinity,a.name=o.name,a.lat=o.geometry.location.lat(),a.lng=o.geometry.location.lng(),a.type="TRAIN_STATION",r.push(a)}}s.resolve(r)}else s.reject("Error getting train stations: "+t)}),s.promise},c}e.$inject=["$http","$resource","$q","$log"],angular.module("itaca.services").factory("GoogleAPI",e)}(),function(){"use strict";function e(e,r,t){var n=this;this.$postLink=function(){n.$hideSiblings(n.hideSiblings),n.$disableScroll()},this.$onInit=function(){n.contClass=n.contClass||"bg-primary text-white md-title",n.errorIconClass=n.errorIconClass||"mdi mdi-alert-circle-outline md-70 text-white",n.progressDiameter=n.progressDiameter||150,n.alertMessageKey=n.alertMessageKey||"common.dont.close.window"},this.$onDestroy=function(){n.$hideSiblings(!1),n.$restoreScroll()},this.$disableScroll=function(){n.$restoreScroll=t.disableScrollAround(r)},this.$hideSiblings=function(e){var t=r.parent().children();e?t.addClass("ng-hide "+n.animationClass):t.removeClass("ng-hide"),r.removeClass("ng-hide")}}e.$inject=["$scope","$element","$mdUtil"],angular.module("itaca.services").component("chLoadingProgress",{bindings:{message:"<",messageKey:"<",errorMessage:"<",errorMessageKey:"<",iconClass:"@",errorIconClass:"@",alertMessage:"<?",alertMessageKey:"<?",hideAlert:"<?",progressDiameter:"@",contClass:"@",hideSiblings:"<",animationClass:"@"},controller:e,template:'<div flex="100" layout="column" class="ch-loading-progress text-center {{$ctrl.contClass}}"><div ng-if="!$ctrl.errorMessage && !$ctrl.errorMessageKey" flex layout="column" layout-padding layout-align="center center"><div ng-if="!$ctrl.iconClass"><md-progress-circular class="ch-progress-white" md-mode="indeterminate" md-diameter="{{$ctrl.progressDiameter}}"></md-progress-circular></div><div ng-if="$ctrl.iconClass"><md-icon class="material-icons {{$ctrl.iconClass}}"></md-icon></div><div ng-if="$ctrl.message || $ctrl.messageKey" class="text-center"><span ng-if="$ctrl.message" ng-bind="$ctrl.message"></span><span ng-if="!$ctrl.message && $ctrl.messageKey" translate="{{$ctrl.messageKey}}"></span></div></div><div ng-if="$ctrl.errorMessage || $ctrl.errorMessageKey" flex layout="column" layout-padding layout-align="center center"><div><md-icon class="material-icons {{$ctrl.errorIconClass}}"></md-icon></div><div class="md-display-2">Oops...</div><div><span ng-if="$ctrl.errorMessage" ng-bind="$ctrl.errorMessage"></span><span ng-if="!$ctrl.errorMessage && $ctrl.errorMessageKey" translate="{{$ctrl.errorMessageKey}}"></span></div></div><div ng-if="$ctrl.hideAlert" layout="column" layout-padding layout-align="center center"><div ng-if="$ctrl.alertMessage || $ctrl.alertMessageKey" class="text-center"><small ng-if="$ctrl.alertMessage" ng-bind="$ctrl.alertMessage"></small><small ng-if="!$ctrl.alertMessage && $ctrl.alertMessageKey" translate="{{$ctrl.alertMessageKey}}"></small></div></div></div>'})}(),function(){"use strict";function e(r,n){var o={},a={active:!1,message:null,messageKey:null,error:null,errorMessage:null,errorMessageKey:null,iconClass:null,errorIconClass:null};return o.start=function(e){if(o.$$loadingScope)o.updateOpts(angular.merge({},a,e,{active:!0}));else{var t={$ctrl:angular.merge({},a,e,{active:!0})};o.$$loadingScope=n.addElement('<ch-loading-progress ng-if="$ctrl.active" message="$ctrl.message" message-key="$ctrl.messageKey" error-message="$ctrl.error ? $ctrl.errorMessage : \'\'" error-message-key="$ctrl.error ? $ctrl.errorMessageKey : \'\'" icon-class="{{$ctrl.iconClass}}" error-icon-class="{{$ctrl.errorIconClass}}" hide-siblings="$ctrl.active" animation-class="animated fadeIn"></ch-loading-progress>',t,null,!0)}},o.stop=function(e){_.isFinite(e)&&e?r(function(){o.updateOpts(a)},e):o.updateOpts(a)},o.isActive=function(){return o.$$loadingScope&&o.$$loadingScope.$ctrl&&o.$$loadingScope.$ctrl.active},o.updateOpts=function(e,t){_.isPlainObject(e)&&(_.isFinite(t)&&t?r(function(){o.$updateOptsNow(e)},t):o.$updateOptsNow(e))},o.$updateOptsNow=function(e){o.$$loadingScope&&(o.$$loadingScope.$ctrl=o.$$loadingScope.$ctrl||{},_.assign(o.$$loadingScope.$ctrl,e))},o}e.$inject=["$timeout","HtmlUtils"],angular.module("itaca.services").factory("LoadingProgress",e)}(),function(){"use strict";function e(e,r,t){var n=this;this.$postLink=function(){n.$disableScroll(),n.$manageSiblings(!_.isNil(n.siblingsClass))},this.$onInit=function(){n.contClass=n.contClass||"md-title",n.progressDiameter=n.progressDiameter||80},this.$onChanges=function(e){e.siblingsClass&&n.$manageSiblings(!_.isNil(n.siblingsClass))},this.$onDestroy=function(){n.$manageSiblings(!1),n.$restoreScroll()},this.$disableScroll=function(){n.$restoreScroll=t.disableScrollAround(r)},this.$manageSiblings=function(e){var t=r.parent().children();e?t.addClass(n.siblingsClass):t.removeClass(n.siblingsClass),r.removeClass(n.siblingsClass)}}e.$inject=["$scope","$element","$mdUtil"],angular.module("itaca.components").component("chLoading",{bindings:{message:"@",messageKey:"@",progressDiameter:"@",contClass:"@",siblingsClass:"@"},controller:e,template:'<div flex layout="column" layout-padding layout-align="center center" class="ch-loading-modal {{$ctrl.contClass}}"><div><md-progress-circular class="md-primary ch-progress" md-mode="indeterminate" md-diameter="{{$ctrl.progressDiameter}}"></md-progress-circular></div><div ng-if="$ctrl.message || $ctrl.messageKey" class="text-center"><span ng-if="$ctrl.message" ng-bind="$ctrl.message"></span><span ng-if="!$ctrl.message && $ctrl.messageKey" translate="{{$ctrl.messageKey}}"></span></div></div>'})}(),function(){"use strict";function e(e,r,n){var o={start:function(e){if(o.$$loadingScope)o.updateOpts({data:e});else{var t={$ctrl:angular.merge({},e,{active:!0})};o.$$loadingScope=n.addElement('<ch-loading ng-if="$ctrl.active" message="{{$ctrl.message}}" message-key="{{$ctrl.messageKey}}"icon-class="{{$ctrl.iconClass}}" siblings-class="blur"></ch-loading>',t,null,!0)}},stop:function(e){r(function(){o.updateOpts({active:!1}),o.$$loadingScope=void 0},_.isFinite(e)?e:0)},updateOpts:function(e,t){_.isPlainObject(e)&&(_.isFinite(t)&&0<t?r(function(){o.$updateOptsNow(e)},t):o.$updateOptsNow(e))},$updateOptsNow:function(e){o.$$loadingScope&&(o.$$loadingScope.$ctrl=o.$$loadingScope.$ctrl||{},_.assign(o.$$loadingScope.$ctrl,e))}};return o}e.$inject=["$rootScope","$timeout","HtmlUtils"],angular.module("itaca.components").factory("Loading",e)}(),function(){"use strict";function u(o,a,s,i,c,e,t,r,n,l){var u=this;this.$$cookieName=n,this.API=t(l,{lang:"@lang"}),this.supported=function(){return[{iso:"it",label:s.instant("language.italian"),flag:"it"},{iso:"en",label:s.instant("language.english"),flag:"gb"}]},this.current=function(){var e=o.get(u.$$cookieName);_.isNil(e)&&(e=a.navigator.language||a.navigator.userLanguage),e=e.split("-")[0];var t=u.get(e);return _.isNil(t)&&(t=u.get(r.defaultLang)),t},this.get=function(e){if(_.isNil(e))return null;e=e.split("-")[0];var t,r=u.supported();for(t in r){var n=r[t];if(_.isEqual(n.iso,e))return n}return null},this.set=function(t){_.isNil(t)&&(t=o.get(u.$$cookieName),_.isNil(t)&&(t=a.navigator.language||a.navigator.userLanguage)),t=t.split("-")[0];var r=e.defer(),n=u.get(t);return _.isNil(n)?r.reject("Language not supported: "+t):u.API.save({lang:t}).$promise.then(function(e){s.use(t),i.set(t),c.changeLocale(t),o.put(u.$$cookieName,n.iso),r.resolve(u.current())},function(e){r.reject("Error setting locale: "+(e.data?e.data.message:""))}),r.promise}}angular.module("itaca.services").provider("Locale",function(){var c="X-ITACA-LOCALE",l="/api/rs/public/lang/:lang";this.init=function(e){e&&(e.cookieName&&($cookieName=e.cookieName),e.postUrl&&(l=e.postUrl))},this.setCookieName=function(e){_.isString(e)&&(c=e)},this.setUrl=function(e){_.isString(e)&&(l=e)},this.$get=["$cookies","$window","$translate","tmhDynamicLocale","amMoment","$q","$resource","AppOptions",function(e,t,r,n,o,a,s,i){return new u(e,t,r,n,o,a,s,i,c,l)}]})}(),function(){"use strict";function m(e,t,n,o,r,a,s,i,c,l,u,g,d,f){"scrollRestoration"in history&&(history.scrollRestoration="manual");var m={offset:_.isFinite(f)?f:0,logout:function(e){a.info("Logging out..."),e=e||"logout",t.post(e,{}).then(function(){a.info("Logout success. Going back to home...")},function(e){a.error("Logout failed!")}).finally(m.home)},login:function(){location.assign("/login")},home:function(e){e?n.open("/"):location.assign("/")},go:function(e,t,r){t?location.assign(e):r?n.open(e):s.url(e)},goBlank:function(e){return m.go(e,!1,!0)},goSecure:function(e){location.assign("/secure/"+(e||""))},goToState:function(e,t,r){return u.go(e||u.current,t,r)},updateCurrentStateParams:function(e){return u.go(u.current,angular.merge({},u.params,e))},reload:function(){n.location.reload()},reloadState:function(e,t){return e?u.transitionTo(e,t,{reload:!0,inherit:!1,notify:!0}):u.reload()},reloadHome:function(){return m.reloadState("home")},redirect:function(e,t){i(function(){s.url("/"+e)},isFinite(t)?t:5e3)},goToAnchor:function(e,t){if(e){e=e.startsWith("#")?e.substring(1):e;var r=document.getElementById(e);null!=r&&o.scrollToElementAnimated(angular.element(r),t&&_.isFinite(parseInt(t))?parseInt(t):m.offset)}},scrollToAnchor:function(e,t){if(e){e=e.startsWith("#")?e.substring(1):e;var r=c.yOffset;c.yOffset=t&&_.isFinite(parseInt(t))?parseInt(t):m.offset,c(e),c.yOffset=r}},top:function(e){window.scrollTo(0,0),e&&(window.onload=function(){window.scrollTo(0,0)})},topAnimated:function(e,t){window.scrollTo({left:0,top:0,behavior:t||"smooth"}),e&&(window.onload=function(){window.scrollTo({left:0,top:0,behavior:t||"smooth"})})},scrollToAnimated:function(e,t){var r=angular.element(_.isString(e)?document.querySelector(e):e)[0];r&&r.scrollIntoView({block:"start",inline:"nearest",behavior:t||"smooth"})},toggleLeftMenu:function(){e.when(l("leftMenu",!0)).then(function(e){e.toggle(),d.hideLeftMenu=!d.hideLeftMenu})},closeLeftMenu:function(t){e.when(l("leftMenu",!0)).then(function(e){e.close(),!_.isNil(t)&&(d.hideLeftMenu=t)})},isLeftMenuOpen:function(){return e.when(l("leftMenu",!0)).then(function(e){return e.isOpen()})},historyBack:function(){n.history.back()},back:function(e){d.page&&d.page.backState?m.goToState(d.page.backState):g.$broadcast("back",e)},goBackState:function(){u.go("^")},next:function(e){g.$broadcast("next",e)},loadUserDetails:function(){g.$broadcast("loadUserDetails")},refreshLocale:function(){g.$broadcast("locale-changed")},refreshNotifications:function(e){e?g.$broadcast("refresh-"+e+"-notifications"):g.$broadcast("refresh-notifications")},closeAllNotifications:function(){g.$broadcast("notifications-close")},disableNavEffect:function(){angular.element(document.querySelector("#navigationDrawer")).addClass("background-no-scroll"),g.config=g.config||{},g.config.navEffectDisabled=!0},enableNavEffect:function(){angular.element(document.querySelector("#navigationDrawer")).removeClass("background-no-scroll"),g.config=g.config||{},g.config.navEffectDisabled=!1}};return m}angular.module("itaca.services").provider("Navigator",function(){var f=0;this.init=function(e){this.setDefaultOffset(e)},this.setDefaultOffset=function(e){_.isFinite(e)&&(f=e)},this.$get=["$q","$http","$window","$document","$animateCss","$log","$location","$timeout","$anchorScroll","$mdSidenav","$state","$rootScope","AppOptions",function(e,t,r,n,o,a,s,i,c,l,u,g,d){return new m(e,t,r,n,o,a,s,i,c,l,u,g,d,f)}]})}(),function(){"use strict";function e(i,o){var a={message:function(e,t,r){var n=o("gt-sm")?"top right":"top";a.showSimple(e,t,r,n,"toast-fixed",!0)},error:function(e,t){var r=o("gt-sm")?"top right":"top";a.showSimple(e,t,null,r,"toast-fixed",!1)},showSimple:function(e,t,r,n,o,a){var s=i.simple().textContent(e).toastClass(o).position(n).capsule(a);angular.isDefined(r)&&s.action(r),i.show(s).then(function(e){angular.isFunction(t)&&t(e)},_.stubFalse)}};return a}e.$inject=["$mdToast","$mdMedia"],angular.module("itaca.services").factory("Notification",e)}(),function(){"use strict";function e(e,r){var t={url:"/api/rs/public/template"},n={managersTerms:{method:"GET",url:t.url+"/terms/manager"},guestsTerms:{method:"GET",url:t.url+"/terms/guest"},cookies:{method:"GET",url:t.url+"/cookies"},privacy:{method:"GET",url:t.url+"/privacy/guest"},aboutUs:{method:"GET",url:t.url+"/aboutUs"},faq:{method:"GET",url:t.url+"/faq"},security:{method:"GET",url:t.url+"/security"},contacts:{method:"GET",url:t.url+"/contacts"},reviewsGuidelines:{method:"GET",url:t.url+"/reviews/guidelines/guest"},reviewsInfo:{method:"GET",url:t.url+"/reviews/info"},reviewsAppInfo:{method:"GET",url:t.url+"/reviews/appinfo"}};return t.REQUEST=e(t.url,{},n),t.managersTerms=function(){var t=r.defer();return this.REQUEST.managersTerms().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting terms and conditions")}),t.promise},t.guestsTerms=function(){var t=r.defer();return this.REQUEST.guestsTerms().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting terms and conditions")}),t.promise},t.cookies=function(){var t=r.defer();return this.REQUEST.cookies().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting cookies")}),t.promise},t.privacy=function(){var t=r.defer();return this.REQUEST.privacy().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting privacy")}),t.promise},t.aboutUs=function(){var t=r.defer();return this.REQUEST.aboutUs().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting about us")}),t.promise},t.faq=function(){var t=r.defer();return this.REQUEST.faq().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting faq")}),t.promise},t.security=function(){var t=r.defer();return this.REQUEST.security().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting security")}),t.promise},t.contacts=function(){var t=r.defer();return this.REQUEST.contacts().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting contacts")}),t.promise},t.reviewsGuidelines=function(){var t=r.defer();return this.REQUEST.reviewsGuidelines().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting reviews guidelines")}),t.promise},t.reviewsInfo=function(){var t=r.defer();return this.REQUEST.reviewsInfo().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting reviews info")}),t.promise},t.reviewsAppInfo=function(){var t=r.defer();return this.REQUEST.reviewsAppInfo().$promise.then(function(e){t.resolve(e)},function(e){t.reject(e.data&&e.data.message?e.data.message:"Error getting reviews app info")}),t.promise},t}e.$inject=["$resource","$q"],angular.module("itaca.factory").factory("Template",e)}(),function(){"use strict";function e(t,r,n,o,e,a,s,i,c){var l={$$deregisters:{onBefore:[],onSuccess:[],onError:[]},enable:function(){function e(e){var t=e.to(),r=e.error();(e.success||!t.redirectTo&&!r.redirected)&&(!e.dynamic()&&!t.isDialog&&i.stop(),s.closeLeftMenu())}l.$$deregisters={onBefore:[],onSuccess:[],onError:[]},l.$$deregisters.onBefore.push(t.onBefore({},function(e){e.dynamic()||e.to().isDialog||(o.cancel(e.to()),!c.isActive()&&i.start())})),l.$$deregisters.onSuccess.push(t.onSuccess({},function(e){var t=e.to();_.includes(e.getResolveTokens(),"title")?e.injector().getAsync("title").then(function(e){a.page=a.page||{},a.page.title=e},_.stubFalse):t.data&&t.data.titleKey&&r(angular.isFunction(t.data.titleKey)?t.data.titleKey():t.data.titleKey).then(function(e){a.page=a.page||{},a.page.title=e},_.stubFalse);a.page=a.page||{},t.data&&t.data.menuItem&&(a.page.currentItem=angular.isFunction(t.data.menuItem)?t.data.menuItem():t.data.menuItem);(_.isNil(location.hash)||_.isEmpty(location.hash))&&!e.dynamic()&&s.topAnimated(!0);a.page.backBtn=t.data&&t.data.backBtn||!1,a.page.backState=null,a.page.backText=t.data&&t.data.backText?t.data.backText:null,_.includes(e.getResolveTokens(),"backState")?(a.page=a.page||{},a.page.backState=e.injector().get("backState")):t.data&&t.data.backState&&(a.page.backState=t.data.backState);a.page.hideNav=t.data&&t.data.hideNav||!1,a.page.hideSearch=t.data&&t.data.hideSearch||!1,a.page.hideTopButton=t.data&&t.data.hideTopButton||!1,0==t.navEffect?s.disableNavEffect():s.enableNavEffect()})),l.$$deregisters.onSuccess.push(t.onSuccess({},e)),l.$$deregisters.onError.push(t.onError({},function(e){var t=e.to(),r=e.error();t.redirectTo||r.redirected||!_.includes([4,6],r.type)||n.error("Error loading page "+t.url+" ("+t.name+"): "+r)})),l.$$deregisters.onError.push(t.onError({},e))},disable:function(e){if(e){var t=l.$$deregisters[e];_.forEach(t,function(e){angular.isFunction(e)&&e()})}else _.forEach(l.$$deregisters,function(e,t){_.forEach(e,function(e){angular.isFunction(e)&&e()})})}};return l}e.$inject=["$transitions","$translate","$log","$mdDialog","InitSrv","AppOptions","Navigator","Loading","LoadingProgress"],angular.module("itaca.services").factory("TransitionsListener",e)}();